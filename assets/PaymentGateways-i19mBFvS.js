import{j as e}from"./ui-DjmETXT1.js";import{u as p,M as y,H as N,g as c,R as i,Y as m,V as o,t as g,v as b,w as u,x as r,y as w,z as d,A as x,Z as v,a5 as T,a6 as _,a7 as C,q as D}from"./index-D5z5fl22.js";import"./vendor-C3n1ReTT.js";import"./supabase-xng3xIeN.js";import"./charts-CVdhJMV6.js";const H=()=>{const{data:n,isLoading:h}=p({queryKey:["admin-payment-transactions"],queryFn:async()=>{const{data:s}=await D.from("payment_transactions").select(`
          id,
          payment_method,
          amount_bdt,
          amount_usd,
          currency,
          status,
          created_at,
          company_id,
          companies(name)
        `).order("created_at",{ascending:!1}).limit(100);return s||[]}}),j=n==null?void 0:n.reduce((s,a)=>{const t=a.payment_method;return s[t]||(s[t]={total:0,successful:0,failed:0,pending:0,revenue:0}),s[t].total+=1,a.status==="completed"?(s[t].successful+=1,s[t].revenue+=a.currency==="BDT"?a.amount_bdt||0:(a.amount_usd||0)*120):a.status==="failed"?s[t].failed+=1:s[t].pending+=1,s},{}),l=s=>new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:0}).format(s).replace("BDT","à§³"),f=s=>{switch(s){case"completed":return e.jsx(C,{className:"h-4 w-4 text-green-500"});case"failed":return e.jsx(_,{className:"h-4 w-4 text-red-500"});default:return e.jsx(T,{className:"h-4 w-4 text-yellow-500"})}};return e.jsx(y,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(N,{className:"h-8 w-8"}),"Payment Gateways"]}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor payment gateway performance and transactions"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:Object.entries(j||{}).map(([s,a])=>e.jsxs(c,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:s})}),e.jsxs(o,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total:"}),e.jsx("span",{className:"font-semibold",children:a.total})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-green-600",children:"Success:"}),e.jsx("span",{className:"font-semibold",children:a.successful})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-red-600",children:"Failed:"}),e.jsx("span",{className:"font-semibold",children:a.failed})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Revenue:"}),e.jsx("span",{className:"font-semibold text-primary",children:l(a.revenue)})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Success Rate: ",a.total>0?Math.round(a.successful/a.total*100):0,"%"]})})]})]},s))}),e.jsxs(c,{children:[e.jsx(i,{children:e.jsx(m,{children:"Recent Transactions"})}),e.jsx(o,{children:h?e.jsx("div",{className:"space-y-3",children:[1,2,3,4,5].map(s=>e.jsx("div",{className:"h-12 bg-muted animate-pulse rounded"},s))}):n&&n.length>0?e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(u,{children:[e.jsx(r,{children:"Company"}),e.jsx(r,{children:"Gateway"}),e.jsx(r,{children:"Amount"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Date"})]})}),e.jsx(w,{children:n.map(s=>{var a;return e.jsxs(u,{children:[e.jsx(d,{className:"font-medium",children:((a=s.companies)==null?void 0:a.name)||"Unknown"}),e.jsx(d,{children:e.jsx(x,{variant:"outline",children:s.payment_method})}),e.jsx(d,{className:"font-semibold",children:s.currency==="BDT"?l(s.amount_bdt||0):`$${s.amount_usd||0}`}),e.jsx(d,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[f(s.status),e.jsx(x,{variant:s.status==="completed"?"default":s.status==="failed"?"destructive":"secondary",children:s.status})]})}),e.jsx(d,{className:"text-sm text-muted-foreground",children:v(new Date(s.created_at),{addSuffix:!0})})]},s.id)})})]}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No transactions found"})})]})]})})};export{H as default};
