import{j as e}from"./ui-DjmETXT1.js";import{Q as _,u as x,M as h,g as r,R as c,V as l,U as C,W as D,H as S,X as U,A as j,Y as u,Z as f,_ as A,q as a}from"./index-D5z5fl22.js";import"./vendor-C3n1ReTT.js";import"./supabase-xng3xIeN.js";import"./charts-CVdhJMV6.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=_("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),L=()=>{const{data:t,isLoading:g}=x({queryKey:["admin-stats"],queryFn:async()=>{const{count:s}=await a.from("profiles").select("*",{count:"exact",head:!0}),{count:i}=await a.from("companies").select("*",{count:"exact",head:!0}),{count:n}=await a.from("company_subscriptions").select("*",{count:"exact",head:!0}).eq("status","active"),{count:y}=await a.from("company_subscriptions").select("*",{count:"exact",head:!0}).eq("status","trial"),{data:m}=await a.from("company_subscriptions").select("amount_paid"),v=(m==null?void 0:m.reduce((b,w)=>b+(w.amount_paid||0),0))||0;return{totalUsers:s||0,totalCompanies:i||0,activeSubscriptions:n||0,trialSubscriptions:y||0,totalRevenue:v}}}),{data:o}=x({queryKey:["recent-users"],queryFn:async()=>{const{data:s}=await a.from("profiles").select("id, name, email, created_at, company_id, companies(name)").order("created_at",{ascending:!1}).limit(10);return s||[]}}),{data:d}=x({queryKey:["recent-subscriptions"],queryFn:async()=>{const{data:s}=await a.from("company_subscriptions").select(`
          id,
          status,
          created_at,
          amount_paid,
          currency,
          company_id,
          companies(name),
          subscription_plans(name)
        `).order("created_at",{ascending:!1}).limit(10);return s||[]}}),p=s=>new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:0}).format(s).replace("BDT","à§³");if(g)return e.jsx(h,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Admin Dashboard"})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(s=>e.jsxs(r,{className:"animate-pulse",children:[e.jsx(c,{className:"h-20 bg-muted"}),e.jsx(l,{className:"h-24 bg-muted/50"})]},s))})]})});const N=[{title:"Total Users",value:(t==null?void 0:t.totalUsers)||0,icon:C,description:"Registered accounts",color:"text-blue-500"},{title:"Total Companies",value:(t==null?void 0:t.totalCompanies)||0,icon:D,description:"Active businesses",color:"text-green-500"},{title:"Active Subscriptions",value:(t==null?void 0:t.activeSubscriptions)||0,icon:S,description:`${(t==null?void 0:t.trialSubscriptions)||0} on trial`,color:"text-purple-500"},{title:"Total Revenue",value:p((t==null?void 0:t.totalRevenue)||0),icon:U,description:"All time",color:"text-primary"}];return e.jsx(h,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Platform-wide statistics and recent activity"})]}),e.jsx(j,{variant:"destructive",className:"text-sm px-3 py-1",children:"SUPER ADMIN"})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:N.map(s=>e.jsxs(r,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(c,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:s.title}),e.jsx(s.icon,{className:`h-5 w-5 ${s.color}`})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.value}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:s.description})]})]},s.title))}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(r,{children:[e.jsx(c,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5"}),"Recent User Registrations"]})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-4",children:o&&o.length>0?o.map(s=>e.jsxs("div",{className:"flex items-center justify-between border-b pb-3 last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email}),s.companies&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Company: ",s.companies.name]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:f(new Date(s.created_at),{addSuffix:!0})})})]},s.id)):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No recent user registrations"})})})]}),e.jsxs(r,{children:[e.jsx(c,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Recent Subscriptions"]})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-4",children:d&&d.length>0?d.map(s=>{var i,n;return e.jsxs("div",{className:"flex items-center justify-between border-b pb-3 last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((i=s.companies)==null?void 0:i.name)||"Unknown Company"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:((n=s.subscription_plans)==null?void 0:n.name)||"Unknown Plan"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(j,{variant:s.status==="active"?"default":"secondary",className:"text-xs",children:s.status}),s.amount_paid&&e.jsx("span",{className:"text-xs text-muted-foreground",children:s.currency==="BDT"?p(s.amount_paid):`$${s.amount_paid}`})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:f(new Date(s.created_at),{addSuffix:!0})})})]},s.id)}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No recent subscriptions"})})})]})]})]})})};export{L as default};
