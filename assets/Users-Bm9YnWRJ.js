import{j as e}from"./ui-DjmETXT1.js";import{r as p,u as c,q as m,M as o,U as y,g as t,t as N,v as f,w as x,x as r,y as g,z as n,A as u,f as b}from"./index-D5z5fl22.js";import{N as v}from"./vendor-C3n1ReTT.js";import"./supabase-xng3xIeN.js";import"./charts-CVdhJMV6.js";function U(){const{user:a}=p(),{data:l,isLoading:h}=c({queryKey:["is-super-admin",a==null?void 0:a.id],queryFn:async()=>{if(!a)return!1;const{data:s}=await m.from("user_roles").select("role").eq("user_id",a.id).eq("role","super_admin").single();return!!s},enabled:!!a}),{data:d,isLoading:j}=c({queryKey:["all-users"],queryFn:async()=>{const{data:s}=await m.from("profiles").select("*, companies(name), user_roles(role)").order("created_at",{ascending:!1});return s||[]},enabled:l===!0});return h?e.jsx(o,{children:e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})})}):l?e.jsx(o,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"All Users"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage all platform users across companies"})]})]}),j?e.jsx(t,{className:"p-6 animate-pulse",children:e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(s=>e.jsx("div",{className:"h-12 bg-muted rounded"},s))})}):!d||d.length===0?e.jsx(t,{className:"p-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No users found"}),e.jsx("p",{className:"text-muted-foreground",children:"Users will appear here as they sign up"})]})}):e.jsx(t,{children:e.jsxs(N,{children:[e.jsx(f,{children:e.jsxs(x,{children:[e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Email"}),e.jsx(r,{children:"Company"}),e.jsx(r,{children:"Role"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Created"})]})}),e.jsx(g,{children:d.map(s=>{var i;return e.jsxs(x,{children:[e.jsx(n,{className:"font-medium",children:s.name}),e.jsx(n,{children:s.email}),e.jsx(n,{children:(i=s.companies)==null?void 0:i.name}),e.jsx(n,{children:e.jsx(u,{variant:"outline",children:s.role||"user"})}),e.jsx(n,{children:e.jsx(u,{variant:s.status==="active"?"default":"secondary",children:s.status||"active"})}),e.jsx(n,{children:s.created_at?b(new Date(s.created_at),"dd MMM yyyy"):"-"})]},s.id)})})]})})]})}):e.jsx(v,{to:"/dashboard",replace:!0})}export{U as default};
