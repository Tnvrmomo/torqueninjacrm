import{j as e}from"./ui-DjmETXT1.js";import{r as g}from"./vendor-C3n1ReTT.js";import{s as k,e as L,u,M as O,B as o,D as h,P as b,a as M,c as w,C as T,f as d,b as _,d as A,g as i,T as I,h as z,i as j,j as y,k as K,l as p,m as v,n as D,o as Q,p as G,q as f}from"./index-D5z5fl22.js";import"./supabase-xng3xIeN.js";import"./charts-CVdhJMV6.js";const Y=()=>{const[l,S]=g.useState(k(new Date)),[n,E]=g.useState(L(new Date)),{data:t}=u({queryKey:["sales-report",l,n],queryFn:async()=>{const{data:s}=await f.from("invoices").select("*").gte("issue_date",d(l,"yyyy-MM-dd")).lte("issue_date",d(n,"yyyy-MM-dd"));return s||[]}}),{data:N}=u({queryKey:["payments-report",l,n],queryFn:async()=>{const{data:s}=await f.from("payments").select("*").gte("payment_date",d(l,"yyyy-MM-dd")).lte("payment_date",d(n,"yyyy-MM-dd"));return s||[]}}),{data:F}=u({queryKey:["expenses-report",l,n],queryFn:async()=>{const{data:s}=await f.from("expenses").select("*").gte("expense_date",d(l,"yyyy-MM-dd")).lte("expense_date",d(n,"yyyy-MM-dd"));return s||[]}}),{data:P}=u({queryKey:["clients"],queryFn:async()=>{const{data:s}=await f.from("clients").select("*");return s||[]}}),C=async()=>{if(!t||t.length===0)return;const s=K(t);p(s,`sales_report_${d(l,"yyyy-MM-dd")}_to_${d(n,"yyyy-MM-dd")}.csv`),await v("sales_report",t.length)},R=async()=>{if(!t||t.length===0)return;const s=D(t);p(s,`vat_report_${d(l,"yyyy-MM-dd")}_to_${d(n,"yyyy-MM-dd")}.csv`),await v("vat_report",t.length)},V=async()=>{if(!t||t.length===0)return;const s=Q(t,P||[]);p(s,`ar_aging_${d(l,"yyyy-MM-dd")}_to_${d(n,"yyyy-MM-dd")}.csv`),await v("ar_aging",t.length)},q=async()=>{if(!t||t.length===0)return;const s=G(t,F||[]);p(s,`profit_loss_${d(l,"yyyy-MM-dd")}_to_${d(n,"yyyy-MM-dd")}.csv`),await v("profit_loss",1)},a=s=>new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:0}).format(s).replace("BDT","à§³"),c=(t==null?void 0:t.reduce((s,r)=>s+r.total,0))||0,B=(N==null?void 0:N.reduce((s,r)=>s+r.amount,0))||0,m=(t==null?void 0:t.reduce((s,r)=>s+r.balance,0))||0,x=(t==null?void 0:t.reduce((s,r)=>s+(r.tax_amount||0),0))||0,$=t==null?void 0:t.reduce((s,r)=>(s[r.status]=(s[r.status]||0)+1,s),{});return e.jsx(O,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Reports"}),e.jsx("p",{className:"text-muted-foreground",children:"Financial reports and analytics"})]}),e.jsxs(o,{variant:"outline",children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Export"]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"From Date"}),e.jsxs(b,{children:[e.jsx(M,{asChild:!0,children:e.jsxs(o,{variant:"outline",className:w("w-[200px] justify-start text-left font-normal"),children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),d(l,"PPP")]})}),e.jsx(_,{className:"w-auto p-0",children:e.jsx(A,{mode:"single",selected:l,onSelect:s=>s&&S(s),initialFocus:!0})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"To Date"}),e.jsxs(b,{children:[e.jsx(M,{asChild:!0,children:e.jsxs(o,{variant:"outline",className:w("w-[200px] justify-start text-left font-normal"),children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),d(n,"PPP")]})}),e.jsx(_,{className:"w-auto p-0",children:e.jsx(A,{mode:"single",selected:n,onSelect:s=>s&&E(s),initialFocus:!0})})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[e.jsxs(i,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Total Sales"}),e.jsx("div",{className:"text-3xl font-bold text-primary",children:a(c)})]}),e.jsxs(i,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Total Collected"}),e.jsx("div",{className:"text-3xl font-bold",children:a(B)})]}),e.jsxs(i,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Outstanding"}),e.jsx("div",{className:"text-3xl font-bold text-destructive",children:a(m)})]}),e.jsxs(i,{className:"p-6",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Total VAT"}),e.jsx("div",{className:"text-3xl font-bold",children:a(x)})]})]}),e.jsxs(I,{defaultValue:"sales",className:"space-y-6",children:[e.jsxs(z,{children:[e.jsx(j,{value:"sales",children:"Sales Report"}),e.jsx(j,{value:"vat",children:"VAT Report"}),e.jsx(j,{value:"aging",children:"A/R Aging"}),e.jsx(j,{value:"pl",children:"P&L Statement"})]}),e.jsx(y,{value:"sales",children:e.jsxs(i,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"Sales Summary"}),e.jsxs(o,{variant:"outline",size:"sm",onClick:C,children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Export"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Invoices"}),e.jsx("div",{className:"text-2xl font-bold",children:(t==null?void 0:t.length)||0})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Average Invoice Value"}),e.jsx("div",{className:"text-2xl font-bold",children:t!=null&&t.length?a(c/t.length):a(0)})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold mb-2",children:"Invoices by Status"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2",children:Object.entries($||{}).map(([s,r])=>e.jsxs("div",{className:"border rounded p-3",children:[e.jsx("div",{className:"text-xs text-muted-foreground uppercase",children:s}),e.jsx("div",{className:"text-xl font-bold",children:r})]},s))})]})]})]})}),e.jsx(y,{value:"vat",children:e.jsxs(i,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"VAT Report (Bangladesh)"}),e.jsxs(o,{variant:"outline",size:"sm",onClick:R,children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Export"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Period"}),e.jsxs("div",{className:"font-medium",children:[d(l,"dd MMM yyyy")," - ",d(n,"dd MMM yyyy")]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Sales"}),e.jsx("div",{className:"text-2xl font-bold",children:a(c)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"VAT Collected (15%)"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:a(x)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Net Sales"}),e.jsx("div",{className:"text-2xl font-bold",children:a(c-x)})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-4",children:"* This report is prepared in accordance with Bangladesh VAT regulations (VAT Act 1991)"})]})]})}),e.jsx(y,{value:"aging",children:e.jsxs(i,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"Accounts Receivable Aging"}),e.jsxs(o,{variant:"outline",size:"sm",onClick:V,children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Export"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:"Outstanding invoices by age"}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Current (0-30 days)"}),e.jsx("div",{className:"text-xl font-bold",children:a(m*.4)})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"31-60 days"}),e.jsx("div",{className:"text-xl font-bold",children:a(m*.3)})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"61-90 days"}),e.jsx("div",{className:"text-xl font-bold",children:a(m*.2)})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"90+ days"}),e.jsx("div",{className:"text-xl font-bold text-destructive",children:a(m*.1)})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-4",children:"* This is a sample aging distribution. Actual implementation would calculate based on invoice due dates."})]})]})}),e.jsx(y,{value:"pl",children:e.jsxs(i,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"Profit & Loss Statement"}),e.jsxs(o,{variant:"outline",size:"sm",onClick:q,children:[e.jsx(h,{className:"h-4 w-4 mr-2"}),"Export"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-2",children:"Revenue"}),e.jsxs("div",{className:"flex justify-between border-b py-2",children:[e.jsx("span",{children:"Sales Revenue"}),e.jsx("span",{className:"font-semibold",children:a(c)})]}),e.jsxs("div",{className:"flex justify-between py-2 font-bold",children:[e.jsx("span",{children:"Total Revenue"}),e.jsx("span",{children:a(c)})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-2",children:"Expenses"}),e.jsxs("div",{className:"flex justify-between border-b py-2",children:[e.jsx("span",{children:"VAT"}),e.jsx("span",{className:"font-semibold",children:a(x)})]}),e.jsxs("div",{className:"flex justify-between py-2 font-bold",children:[e.jsx("span",{children:"Total Expenses"}),e.jsx("span",{children:a(x)})]})]}),e.jsx("div",{className:"border-t-2 pt-4",children:e.jsxs("div",{className:"flex justify-between text-xl font-bold",children:[e.jsx("span",{children:"Net Income"}),e.jsx("span",{className:"text-primary",children:a(c-x)})]})}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"* This is a simplified P&L. Full implementation would include cost of goods sold, operating expenses, etc."})]})]})})]})]})})};export{Y as default};
