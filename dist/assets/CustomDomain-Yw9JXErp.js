import{j as e}from"./ui-DjmETXT1.js";import{r as f}from"./vendor-C3n1ReTT.js";import{r as j,E as g,u,q as i,F as b,M as N,K as w,g as d,A as _,N as v,O as q,L as S,I as D,B as C,J as x}from"./index-D5z5fl22.js";import"./supabase-xng3xIeN.js";import"./charts-CVdhJMV6.js";function k(){const{user:n}=j(),h=g(),[r,c]=f.useState(""),{data:a}=u({queryKey:["profile",n==null?void 0:n.id],queryFn:async()=>{const{data:s}=await i.from("profiles").select("company_id").eq("user_id",n.id).single();return s},enabled:!!n}),{data:t}=u({queryKey:["custom-domain",a==null?void 0:a.company_id],queryFn:async()=>{const{data:s}=await i.from("custom_domains").select("*").eq("company_id",a.company_id).single();return s},enabled:!!(a!=null&&a.company_id)}),o=b({mutationFn:async s=>{const m=Math.random().toString(36).substring(2,15),{data:y,error:l}=await i.from("custom_domains").insert({company_id:a.company_id,domain:s,verification_token:m,dns_records:{a_record:"@ -> [Your_Server_IP]",www_record:"www -> [Your_Server_IP]",txt_record:`_torqueninja-verify -> ${m}`}}).select().single();if(l)throw l;return y},onSuccess:()=>{h.invalidateQueries({queryKey:["custom-domain"]}),x.success("Domain request submitted"),c("")},onError:s=>{x.error(s.message||"Failed to request domain")}}),p=s=>{s.preventDefault(),r&&o.mutate(r)};return e.jsx(N,{children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Custom Domain"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect your own domain to your TorqueNinja dashboard"})]})]}),t?e.jsxs(d,{className:"p-6 space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-lg",children:t.domain}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Status:",e.jsx(_,{className:"ml-2",variant:t.status==="active"?"default":"secondary",children:t.status})]})]})}),t.status==="pending"&&e.jsx(v,{children:e.jsxs(q,{children:[e.jsx("p",{className:"font-semibold mb-2",children:"Please add these DNS records to your domain:"}),e.jsx("pre",{className:"bg-background p-4 rounded-lg text-sm overflow-x-auto",children:`A Record:
  Name: @
  Value: [Contact Admin for IP]
  TTL: 3600

A Record:
  Name: www
  Value: [Contact Admin for IP]
  TTL: 3600

TXT Record:
  Name: _torqueninja-verify
  Value: ${t.verification_token}
  TTL: 3600`}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"DNS changes can take up to 72 hours to propagate. We'll automatically verify your domain."})]})})]}):e.jsx(d,{className:"p-6",children:e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(S,{htmlFor:"domain",children:"Your Domain"}),e.jsx(D,{id:"domain",value:r,onChange:s=>c(s.target.value),placeholder:"mybusiness.com",required:!0}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Enter your domain without http:// or www"})]}),e.jsx(C,{type:"submit",disabled:o.isPending,children:o.isPending?"Requesting...":"Request Custom Domain"})]})}),e.jsxs(d,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Benefits of Custom Domain"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsx("li",{children:"✓ Professional branded URL for your business"}),e.jsx("li",{children:"✓ Automatic SSL certificate (HTTPS)"}),e.jsx("li",{children:"✓ Better SEO and brand recognition"}),e.jsx("li",{children:"✓ Custom email addresses possible"})]})]})]})})}export{k as default};
